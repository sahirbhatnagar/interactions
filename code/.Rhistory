rm(list = ls())
source("packages.R")
source("data.R")
source("functions.R")
res <- shim(x = X, y = Y, main.effect.names = main_effect_names,
interaction.names = interaction_names,
lambda.beta = 1, lambda.gamma = 1, threshold = 1e-5, max.iter = 500)
res$beta
matplot(res$beta[,1:res$m] %>% t, type = "l", ylab="")
names(beta1)
X[,names(beta1)]
beta1
rm(list = ls())
source("packages.R")
source("data.R")
source("functions.R")
res <- shim(x = X, y = Y, main.effect.names = main_effect_names,
interaction.names = interaction_names,
lambda.beta = 1, lambda.gamma = 1, threshold = 1e-5, max.iter = 500)
matplot(res$beta[,1:res$m] %>% t, type = "l", ylab="")
matplot(res$beta[,1:res$m] %>% t, type = "l", ylab="")
dev.off()
par(mfrow=c(2,1))
matplot(res$beta[,1:res$m] %>% t, type = "l", ylab="")
matplot(res$gamma[,1:res$m] %>% t, type = "l", ylab="")
dev.off()
matplot(res$beta[,1:res$m] %>% t, type = "l", ylab="")
matplot(res$gamma[,1:res$m] %>% t, type = "l", ylab="")
res$gamma[,res$m, drop=F] %>% plot
res$beta[,res$m, drop=F] %>% plot
res$beta[,res$m, drop=F]
rm(list = ls())
source("packages.R")
source("data.R")
source("functions.R")
res <- shim(x = X, y = Y, main.effect.names = main_effect_names,
interaction.names = interaction_names,
lambda.beta = 1, lambda.gamma = 1, threshold = 1e-5, max.iter = 500)
rm(list = ls())
source("packages.R")
source("data.R")
source("functions.R")
res <- shim(x = X, y = Y, main.effect.names = main_effect_names,
interaction.names = interaction_names,
lambda.beta = 1, lambda.gamma = 1, threshold = 1e-5, max.iter = 500)
rm(list = ls())
source("packages.R")
source("data.R")
source("functions.R")
res <- shim(x = X, y = Y, main.effect.names = main_effect_names,
interaction.names = interaction_names,
lambda.beta = 1, lambda.gamma = 1, threshold = 1e-5, max.iter = 500)
rm(list = ls())
source("packages.R")
source("data.R")
source("functions.R")
res <- shim(x = X, y = Y, main.effect.names = main_effect_names,
interaction.names = interaction_names,
lambda.beta = 1, lambda.gamma = 1, threshold = 1e-5, max.iter = 500)
rm(list = ls())
source("packages.R")
source("data.R")
source("functions.R")
res <- shim(x = X, y = Y, main.effect.names = main_effect_names,
interaction.names = interaction_names,
lambda.beta = 1, lambda.gamma = 1, threshold = 1e-5, max.iter = 500)
rm(list = ls())
source("packages.R")
source("data.R")
source("functions.R")
res <- shim(x = X, y = Y, main.effect.names = main_effect_names,
interaction.names = interaction_names,
lambda.beta = 1, lambda.gamma = 1, threshold = 1e-5, max.iter = 500)
matplot(res$beta[,1:res$m] %>% t, type = "l", ylab="")
res$beta[,res$m, drop=F]
res <- shim(x = X, y = Y, main.effect.names = main_effect_names,
interaction.names = interaction_names,
lambda.beta = 0.5, lambda.gamma = 1, threshold = 1e-5, max.iter = 500)
rm(list = ls())
source("packages.R")
source("data.R")
source("functions.R")
res <- shim(x = X, y = Y, main.effect.names = main_effect_names,
interaction.names = interaction_names,
lambda.beta = 1, lambda.gamma = 1, threshold = 1e-5, max.iter = 500)
rm(list = ls())
source("packages.R")
source("data.R")
source("functions.R")
res <- shim(x = X, y = Y, main.effect.names = main_effect_names,
interaction.names = interaction_names,
lambda.beta = 1.5, lambda.gamma = 1, threshold = 1e-5, max.iter = 500)
rm(list = ls())
source("packages.R")
source("data.R")
source("functions.R")
res <- shim(x = X, y = Y, main.effect.names = main_effect_names,
interaction.names = interaction_names,
lambda.beta = 1.2, lambda.gamma = 1, threshold = 1e-5, max.iter = 500)
rm(list = ls())
source("packages.R")
source("data.R")
source("functions.R")
res <- shim(x = X, y = Y, main.effect.names = main_effect_names,
interaction.names = interaction_names,
lambda.beta = 0.5, lambda.gamma = 1.5, threshold = 1e-5, max.iter = 500)
rm(list = ls())
source("packages.R")
source("data.R")
source("functions.R")
res <- shim(x = X, y = Y, main.effect.names = main_effect_names,
interaction.names = interaction_names,
lambda.beta = 0.5, lambda.gamma = 0.8, threshold = 1e-5, max.iter = 500)
rm(list = ls())
source("packages.R")
source("data.R")
source("functions.R")
res <- shim(x = X, y = Y, main.effect.names = main_effect_names,
interaction.names = interaction_names,
lambda.beta = 0.5, lambda.gamma = 0.8, threshold = 1e-5, max.iter = 500)
rm(list = ls())
source("packages.R")
source("data.R")
source("functions.R")
res <- shim(x = X, y = Y, main.effect.names = main_effect_names,
interaction.names = interaction_names,
lambda.beta = 0.5, lambda.gamma = 0.8, threshold = 1e-5, max.iter = 500)
rm(list = ls())
source("packages.R")
source("data.R")
source("functions.R")
res <- shim(x = X, y = Y, main.effect.names = main_effect_names,
interaction.names = interaction_names,
lambda.beta = 0.5, lambda.gamma = 0.8, threshold = 1e-5, max.iter = 500)
rm(list = ls())
source("packages.R")
source("data.R")
source("functions.R")
res <- shim(x = X, y = Y, main.effect.names = main_effect_names,
interaction.names = interaction_names,
lambda.beta = 0.5, lambda.gamma = 0.8, threshold = 1e-5, max.iter = 500)
rm(list = ls())
source("packages.R")
source("data.R")
source("functions.R")
res <- shim(x = X, y = Y, main.effect.names = main_effect_names,
interaction.names = interaction_names,
lambda.beta = 0.5, lambda.gamma = 0.8, threshold = 1e-5, max.iter = 500)
rm(list = ls())
source("packages.R")
source("data.R")
source("functions.R")
res <- shim(x = X, y = Y, main.effect.names = main_effect_names,
interaction.names = interaction_names,
lambda.beta = 0.5, lambda.gamma = 0.8, threshold = 1e-5, max.iter = 500)
rm(list = ls())
source("packages.R")
source("data.R")
source("functions.R")
res <- shim(x = X, y = Y, main.effect.names = main_effect_names,
interaction.names = interaction_names,
lambda.beta = 0.5, lambda.gamma = 0.8, threshold = 1e2, max.iter = 500)
rm(list = ls())
source("packages.R")
source("data.R")
source("functions.R")
res <- shim(x = X, y = Y, main.effect.names = main_effect_names,
interaction.names = interaction_names,
lambda.beta = 0.5, lambda.gamma = 0.8, threshold = 1e1, max.iter = 500)
1e1
1e-1
rm(list = ls())
source("packages.R")
source("data.R")
source("functions.R")
res <- shim(x = X, y = Y, main.effect.names = main_effect_names,
interaction.names = interaction_names,
lambda.beta = 0.5, lambda.gamma = 0.8, threshold = 1e-1, max.iter = 500)
dev.off()
matplot(res$beta[,1:res$m] %>% t, type = "l", ylab="")
matplot(res$gamma[,1:res$m] %>% t, type = "l", ylab="")
rm(list = ls())
source("packages.R")
source("data.R")
source("functions.R")
res <- shim(x = X, y = Y, main.effect.names = main_effect_names,
interaction.names = interaction_names,
lambda.beta = 0.5, lambda.gamma = 0.8, threshold = 1e-2, max.iter = 500)
rm(list = ls())
source("packages.R")
source("data.R")
source("functions.R")
res <- shim(x = X, y = Y, main.effect.names = main_effect_names,
interaction.names = interaction_names,
lambda.beta = 0.5, lambda.gamma = 0.8, threshold = 1e-4, max.iter = 500)
rm(list = ls())
source("packages.R")
source("data.R")
source("functions.R")
res <- shim(x = X, y = Y, main.effect.names = main_effect_names,
interaction.names = interaction_names,
lambda.beta = 0.05, lambda.gamma = 0.05, threshold = 1e-4, max.iter = 500)
rm(list = ls())
source("packages.R")
source("data.R")
source("functions.R")
res <- shim(x = X, y = Y, main.effect.names = main_effect_names,
interaction.names = interaction_names,
lambda.beta = 50, lambda.gamma = 20, threshold = 1e-4, max.iter = 500)
rm(list = ls())
source("packages.R")
source("data.R")
source("functions.R")
res <- shim(x = X, y = Y, main.effect.names = main_effect_names,
interaction.names = interaction_names,
lambda.beta = 0.5, lambda.gamma = 20, threshold = 1e-4, max.iter = 500)
rm(list = ls())
source("packages.R")
source("data.R")
source("functions.R")
res <- shim(x = X, y = Y, main.effect.names = main_effect_names,
interaction.names = interaction_names,
lambda.beta = 1, lambda.gamma = 1, threshold = 1e-4, max.iter = 500)
res$gamma[,res$m, drop=F] %>% plot
res$beta[,res$m, drop=F] %>% plot
set.seed(12)
x=matrix(rnorm(100*10),ncol=10)
e=matrix(rbinom(100,1,0.5), ncol=1)
e
install.packages("hierNet")
library(hierNet)
set.seed(12)
x=matrix(rnorm(100*10),ncol=10)
e=matrix(rbinom(100,1,0.5), ncol=1)
hierNet::compute.interactions.c(x)
hierNet::compute.interactions.c(x) %>% head
x*e
x%*%e
compute.interactions.c
hierNet::compute.interactions.c(cbind2(x,e)) %>% head
hierNet::compute.interactions.c(cbind2(x,e)) %>% colnames()
e
hierNet::compute.interactions.c(cbind2(x,e)) %>% colnames() %>% grep("11", .)
hierNet::compute.interactions.c(cbind2(x,e)) %>% colnames() %>% grep("11", value = T)
hierNet::compute.interactions.c(cbind2(x,e)) %>% colnames() %>% grep("11",., value = T)
paste0(1:10, ":",1:10)
DT <- hierNet::compute.interactions.c(cbind2(x,e))
X <- hierNet::compute.interactions.c(cbind2(x,e))
nvars = 10
set.seed(12)
p = 10
n = 200
x=matrix(rnorm(n*p),ncol=p)
e=matrix(rbinom(n,1,0.5), ncol=1)
X <- hierNet::compute.interactions.c(cbind2(x,e))
(columns.to.keep <- c(paste0(1:p, ":",1:p), X %>% colnames() %>% grep("11",., value = T) ) )
(columns.to.keep <- c(paste0(1:p, ":",1:p), X %>% colnames() %>% grep("11",., value = T)))
"%ni" <- Negate("%in%")
X[,colnames(X) %ni% columns.to.keep ]
"%ni" <- Negate("%in%")
X[,colnames(X) %ni% columns.to.keep ]
"%ni" <- Negate("%in%")
"%ni%" <- Negate("%in%")
X[,colnames(X) %ni% columns.to.keep ]
X[,colnames(X) %ni% columns.to.keep ] %>% colnames
X[,colnames(X) %ni% columns.to.keep ] <- 0
head(X)
X=scale(X,TRUE,TRUE)
head(X)
head(X)
X <- hierNet::compute.interactions.c(cbind2(x,e))
(columns.to.keep <- c(paste0(1:p, ":",1:p), X %>% colnames() %>% grep("11",., value = T)))
X[,colnames(X) %ni% columns.to.keep ] <- 0
head(X)
X[,"1:1"]
y=X[,"1:1"]+2*X[,"5:5"]^2+ X[,"1:11"] + X[,"5:11"]+3*rnorm(100)
fit=hierNet.path(cbind2(x,e),y, zz = X)
fitcv=hierNet.cv(fit,cbind2(x,e),y, zz = X)
fitcv=hierNet.cv(fit,cbind2(x,e),y)
print(fitcv)
plot(fitccv)
plot(fitcv)
y=X[,"1:1"]+2*X[,"5:5"]^2+ X[,"1:11"] + X[,"5:11"]+0.5*rnorm(100)
fit=hierNet.path(cbind2(x,e),y, zz = X)
fitcv=hierNet.cv(fit,cbind2(x,e),y)
print(fitcv)
plot(fitcv)
print(fitcv)
fitcv$lamlist
fitcv$nonzero
fitcv$folds
fitcv$call
fit$lamlist
fit$bp
fit$th
print(fitcv)
fitcv$lamhat.1se
fitcv$lamhat
y=X[,"1:1"]+2*X[,"5:5"]+ X[,"1:11"] + X[,"5:11"]+0.5*rnorm(100)
fit=hierNet.path(cbind2(x,e),y, zz = X)
fitcv=hierNet.cv(fit,cbind2(x,e),y)
print(fitcv)
plot(fitcv)
set.seed(12)
p = 10
n = 200
x=matrix(rnorm(n*p),ncol=p)
e=matrix(rbinom(n,1,0.5), ncol=1)
X <- hierNet::compute.interactions.c(cbind2(x,e))
(columns.to.keep <- c(paste0(1:p, ":",1:p), X %>% colnames() %>% grep("11",., value = T)))
X[,colnames(X) %ni% columns.to.keep ] <- 0
head(X)
X=scale(X,TRUE,TRUE)
y=X[,"1:1"]+2*X[,"5:5"]+ X[,"1:11"] + X[,"5:11"]+0.5*rnorm(100)
fit=hierNet.path(cbind2(x,e),y, zz = X)
X=scale(X[,columns.to.keep],TRUE,TRUE)
X
dim(X)
rm(list = ls())
source("packages.R")
"%ni%" <- Negate("%in%")
set.seed(12)
p = 10
n = 200
x=matrix(rnorm(n*p),ncol=p)
e=matrix(rbinom(n,1,0.5), ncol=1)
X <- hierNet::compute.interactions.c(cbind2(x,e))
(columns.to.keep <- c(paste0(1:p, ":",1:p), X %>% colnames() %>% grep("11",., value = T)))
X[,colnames(X) %ni% columns.to.keep ] <- 0
head(X)
y=X[,"1:1"]+2*X[,"5:5"]+ X[,"1:11"] + X[,"5:11"]+3*rnorm(n)
y=X[,"1:1"]+2*X[,"5:5"]+ X[,"1:11"] + X[,"5:11"]+3*rnorm(n-100)
y=X[,"1:1"]+2*X[,"5:5"]+ X[,"1:11"] + X[,"5:11"]+3*rnorm(n)
fit=hierNet.path(cbind2(x,e),y, zz = X)
y=X[,"1:1"]+2*X[,"5:5"]+ 1.5*X[,"1:11"] + X[,"5:11"]+3*rnorm(n)
fit=hierNet.path(cbind2(x,e),y, zz = X)
fitcv=hierNet.cv(fit,cbind2(x,e),y)
print(fitcv)
plot(fitcv)
fit$th
fit$th[,,18]
fit$th[,,which(fitcv$lamhat.1se==fit$lamlist)]
fit$bp
fit$bp[,which(fitcv$lamhat.1se==fit$lamlist)]
fit$bp[,which(fitcv$lamhat.1se==fit$lamlist), drop = F] - fit$bn[,which(fitcv$lamhat.1se==fit$lamlist), drop = F]
fit$th[,,which(fitcv$lamhat.1se==fit$lamlist)]
print(fitcv)
y=X[,"1:1"]+2*X[,"5:5"]+ 1.5*X[,"1:11"] + 4*X[,"5:11"]+3*rnorm(n)
fit=hierNet.path(cbind2(x,e),y, zz = X)
fitcv=hierNet.cv(fit,cbind2(x,e),y)
print(fitcv)
plot(fitcv)
y=X[,"1:1"]+ X[,"5:5"] + X[,"11:11"] + 1.5*X[,"1:11"] + 1.5*X[,"5:11"]+3*rnorm(n)
fit=hierNet.path(cbind2(x,e),y, zz = X)
fitcv=hierNet.cv(fit,cbind2(x,e),y)
print(fitcv)
plot(fitcv)
y=X[,"1:1"]+ X[,"5:5"] + X[,"11:11"] + 1.5*X[,"1:11"] + 1.5*X[,"5:11"]+1.5*rnorm(n)
fit=hierNet.path(cbind2(x,e),y, zz = X)
fitcv=hierNet.cv(fit,cbind2(x,e),y)
print(fitcv)
plot(fitcv)
p = 1000
n = 200
x=matrix(rnorm(n*p),ncol=p)
e=matrix(rbinom(n,1,0.5), ncol=1)
X <- hierNet::compute.interactions.c(cbind2(x,e))
rm(X)
